<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CyberSpy - Educational Security Tool</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Courier New', monospace;
            background: linear-gradient(135deg, #0a0a0a 0%, #1a1a2e 50%, #16213e 100%);
            color: #00ff41;
            overflow-x: hidden;
            min-height: 100vh;
        }

        .matrix-bg {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 0;
            opacity: 0.1;
        }

        .container {
            position: relative;
            z-index: 1;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            text-align: center;
            margin-bottom: 30px;
            background: rgba(0, 255, 65, 0.1);
            border: 2px solid #00ff41;
            border-radius: 10px;
            padding: 20px;
            animation: glow 2s ease-in-out infinite alternate;
        }

        @keyframes glow {
            from { box-shadow: 0 0 20px rgba(0, 255, 65, 0.3); }
            to { box-shadow: 0 0 30px rgba(0, 255, 65, 0.6); }
        }

        .title {
            font-size: 2.5em;
            text-shadow: 0 0 10px #00ff41;
            margin-bottom: 10px;
        }

        .subtitle {
            color: #00ccff;
            font-size: 1.2em;
        }

        .dashboard {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .crypto-panel {
            grid-column: 1 / -1;
            background: rgba(0, 20, 40, 0.9);
            border: 2px solid #00ccff;
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 20px;
        }

        .crypto-tools {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .crypto-section {
            background: rgba(0, 0, 0, 0.5);
            border: 1px solid #00ff41;
            border-radius: 10px;
            padding: 15px;
        }

        .input-group {
            margin: 10px 0;
        }

        .input-group label {
            display: block;
            color: #00ccff;
            margin-bottom: 5px;
            font-size: 0.9em;
        }

        .input-group input, .input-group textarea {
            width: 100%;
            background: rgba(0, 0, 0, 0.7);
            border: 1px solid #333;
            border-radius: 5px;
            padding: 8px;
            color: #00ff41;
            font-family: 'Courier New', monospace;
            font-size: 12px;
        }

        .input-group textarea {
            resize: vertical;
            min-height: 60px;
        }

        .crypto-btn {
            background: linear-gradient(45deg, #00ff41, #00ccff);
            border: none;
            border-radius: 5px;
            padding: 8px 15px;
            color: #000;
            font-weight: bold;
            cursor: pointer;
            margin: 5px;
            transition: all 0.3s ease;
        }

        .crypto-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 255, 65, 0.3);
        }

        .crypto-output {
            background: rgba(0, 0, 0, 0.8);
            border: 1px solid #333;
            border-radius: 5px;
            padding: 10px;
            color: #00ff41;
            font-family: 'Courier New', monospace;
            font-size: 12px;
            min-height: 80px;
            margin-top: 10px;
            white-space: pre-wrap;
        }

        .brute-force-results {
            max-height: 200px;
            overflow-y: auto;
        }

        .result-item {
            padding: 5px;
            border-bottom: 1px solid #333;
            cursor: pointer;
            transition: background 0.2s;
        }

        .result-item:hover {
            background: rgba(0, 255, 65, 0.1);
        }

        .frequency-analysis {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(40px, 1fr));
            gap: 5px;
            margin: 10px 0;
        }

        .freq-bar {
            text-align: center;
            font-size: 10px;
        }

        .freq-letter {
            color: #00ccff;
        }

        .freq-count {
            display: block;
            height: 20px;
            background: linear-gradient(to top, #00ff41, #00ccff);
            margin: 2px 0;
            border-radius: 2px;
        }

        .panel {
            background: rgba(0, 0, 0, 0.8);
            border: 1px solid #00ff41;
            border-radius: 10px;
            padding: 20px;
            backdrop-filter: blur(10px);
            transition: all 0.3s ease;
        }

        .panel:hover {
            border-color: #00ccff;
            transform: translateY(-5px);
        }

        .panel-header {
            display: flex;
            align-items: center;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 1px solid #333;
        }

        .panel-icon {
            font-size: 1.5em;
            margin-right: 10px;
            color: #00ccff;
        }

        .panel-title {
            font-size: 1.3em;
            color: #00ff41;
        }

        .metric {
            display: flex;
            justify-content: space-between;
            margin: 10px 0;
            padding: 5px;
            background: rgba(0, 255, 65, 0.1);
            border-radius: 5px;
        }

        .terminal {
            background: rgba(0, 0, 0, 0.9);
            border: 2px solid #00ff41;
            border-radius: 10px;
            padding: 20px;
            margin-top: 20px;
            height: 400px;
            overflow-y: auto;
            font-family: 'Courier New', monospace;
        }

        .terminal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 1px solid #00ff41;
        }

        .terminal-title {
            color: #00ccff;
            font-weight: bold;
        }

        .terminal-controls {
            display: flex;
            gap: 5px;
        }

        .control-btn {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: #ff5f56;
        }

        .control-btn:nth-child(2) { background: #ffbd2e; }
        .control-btn:nth-child(3) { background: #27ca3f; }

        .terminal-output {
            max-height: 300px;
            overflow-y: auto;
            margin-bottom: 15px;
        }

        .terminal-line {
            margin: 5px 0;
            animation: typewriter 0.5s ease-out;
        }

        @keyframes typewriter {
            from { width: 0; opacity: 0; }
            to { width: 100%; opacity: 1; }
        }

        .terminal-input {
            display: flex;
            align-items: center;
        }

        .prompt {
            color: #00ccff;
            margin-right: 10px;
        }

        .input-field {
            flex: 1;
            background: transparent;
            border: none;
            color: #00ff41;
            font-family: 'Courier New', monospace;
            font-size: 14px;
            outline: none;
        }

        .input-field::placeholder {
            color: #666;
        }

        .status-bar {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: rgba(0, 0, 0, 0.9);
            padding: 10px;
            border-top: 1px solid #00ff41;
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 12px;
        }

        .status-item {
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .blink {
            animation: blink 1s infinite;
        }

        @keyframes blink {
            50% { opacity: 0; }
        }

        .progress-bar {
            width: 100%;
            height: 20px;
            background: rgba(0, 0, 0, 0.5);
            border: 1px solid #00ff41;
            border-radius: 10px;
            overflow: hidden;
            margin: 10px 0;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #00ff41, #00ccff);
            width: 0%;
            transition: width 1s ease;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.7; }
        }

        @media (max-width: 768px) {
            .title {
                font-size: 2em;
            }
            
            .dashboard {
                grid-template-columns: 1fr;
            }
            
            .container {
                padding: 10px;
            }
            
            .terminal {
                height: 300px;
            }
        }
    </style>
</head>
<body>
    <canvas class="matrix-bg" id="matrixCanvas"></canvas>
    
    <div class="container">
        <div class="header">
            <div class="title">üïµÔ∏è CYBERSPY</div>
            <div class="subtitle">Educational Security Monitoring System</div>
        </div>

        <div class="crypto-panel">
            <div class="panel-header">
                <div class="panel-icon">üîê</div>
                <div class="panel-title">Advanced Cryptography Lab</div>
            </div>
            <div class="crypto-tools">
                <div class="crypto-section">
                    <h3 style="color: #00ccff; margin-bottom: 15px;">üî§ Caesar Cipher</h3>
                    <div class="input-group">
                        <label>Message:</label>
                        <textarea id="caesarInput" placeholder="Enter your message..."></textarea>
                    </div>
                    <div class="input-group">
                        <label>Shift (1-25):</label>
                        <input type="number" id="caesarShift" min="1" max="25" value="3">
                    </div>
                    <button class="crypto-btn" onclick="caesarEncrypt()">Encrypt</button>
                    <button class="crypto-btn" onclick="caesarDecrypt()">Decrypt</button>
                    <button class="crypto-btn" onclick="caesarBruteForce()">Brute Force</button>
                    <div class="crypto-output" id="caesarOutput">Results will appear here...</div>
                </div>

                <div class="crypto-section">
                    <h3 style="color: #00ccff; margin-bottom: 15px;">üìú Vigen√®re Cipher</h3>
                    <div class="input-group">
                        <label>Message:</label>
                        <textarea id="vigenereInput" placeholder="Enter your message..."></textarea>
                    </div>
                    <div class="input-group">
                        <label>Key:</label>
                        <input type="text" id="vigenereKey" placeholder="Enter key...">
                    </div>
                    <button class="crypto-btn" onclick="vigenereEncrypt()">Encrypt</button>
                    <button class="crypto-btn" onclick="vigenereDecrypt()">Decrypt</button>
                    <button class="crypto-btn" onclick="vigenereAnalyze()">Key Analysis</button>
                    <div class="crypto-output" id="vigenereOutput">Results will appear here...</div>
                </div>

                <div class="crypto-section">
                    <h3 style="color: #00ccff; margin-bottom: 15px;">üïµÔ∏è Frequency Analysis</h3>
                    <div class="input-group">
                        <label>Cipher Text:</label>
                        <textarea id="frequencyInput" placeholder="Enter cipher text for analysis..."></textarea>
                    </div>
                    <button class="crypto-btn" onclick="performFrequencyAnalysis()">Analyze</button>
                    <div class="frequency-analysis" id="frequencyChart"></div>
                    <div class="crypto-output" id="frequencyOutput">Frequency analysis results...</div>
                </div>

                <div class="crypto-section">
                    <h3 style="color: #00ccff; margin-bottom: 15px;">‚ö° Hybrid Cipher Breaker</h3>
                    <div class="input-group">
                        <label>Encrypted Message:</label>
                        <textarea id="hybridInput" placeholder="Enter encrypted text to crack..."></textarea>
                    </div>
                    <button class="crypto-btn" onclick="hybridCrack()">Auto-Crack</button>
                    <div class="crypto-output brute-force-results" id="hybridOutput">Crack attempts will appear here...</div>
                </div>
            </div>
        </div>

        <div class="dashboard">
            <div class="panel">
                <div class="panel-header">
                    <div class="panel-icon">üåê</div>
                    <div class="panel-title">Network Monitor</div>
                </div>
                <div class="metric">
                    <span>Active Connections:</span>
                    <span id="connections">42</span>
                </div>
                <div class="metric">
                    <span>Packets/sec:</span>
                    <span id="packets">1,247</span>
                </div>
                <div class="metric">
                    <span>Bandwidth:</span>
                    <span id="bandwidth">89.3 MB/s</span>
                </div>
                <div class="progress-bar">
                    <div class="progress-fill" id="networkProgress"></div>
                </div>
            </div>

            <div class="panel">
                <div class="panel-header">
                    <div class="panel-icon">üîí</div>
                    <div class="panel-title">Security Status</div>
                </div>
                <div class="metric">
                    <span>Threat Level:</span>
                    <span style="color: #00ff41;">LOW</span>
                </div>
                <div class="metric">
                    <span>Firewall:</span>
                    <span style="color: #00ff41;">ACTIVE</span>
                </div>
                <div class="metric">
                    <span>Last Scan:</span>
                    <span id="lastScan">2 min ago</span>
                </div>
                <div class="progress-bar">
                    <div class="progress-fill" id="securityProgress"></div>
                </div>
            </div>

            <div class="panel">
                <div class="panel-header">
                    <div class="panel-icon">üíª</div>
                    <div class="panel-title">System Resources</div>
                </div>
                <div class="metric">
                    <span>CPU Usage:</span>
                    <span id="cpu">34%</span>
                </div>
                <div class="metric">
                    <span>Memory:</span>
                    <span id="memory">67%</span>
                </div>
                <div class="metric">
                    <span>Disk I/O:</span>
                    <span id="diskio">Low</span>
                </div>
                <div class="progress-bar">
                    <div class="progress-fill" id="systemProgress"></div>
                </div>
            </div>

            <!-- <div class="panel">
                <div class="panel-header">
                    <div class="panel-icon">üéØ</div>
                    <div class="panel-title">Mission Status</div>
                </div>
                <div class="metric">
                    <span>Objective:</span>
                    <span style="color: #00ccff;">LEARNING</span>
                </div>
                <div class="metric">
                    <span>Progress:</span>
                    <span id="missionProgress">78%</span>
                </div>
                <div class="metric">
                    <span>Skills Unlocked:</span>
                    <span id="skillsUnlocked">12/20</span>
                </div>
                <div class="progress-bar">
                    <div class="progress-fill" id="missionProgressBar"></div>
                </div>
            </div> -->
        </div>

        <div class="terminal">
            <div class="terminal-header">
                <div class="terminal-title">CyberSpy Terminal v2.1.0</div>
                <div class="terminal-controls">
                    <div class="control-btn"></div>
                    <div class="control-btn"></div>
                    <div class="control-btn"></div>
                </div>
            </div>
            <div class="terminal-output" id="terminalOutput">
                <div class="terminal-line">Welcome to CyberSpy Educational Terminal</div>
                <div class="terminal-line">Type 'help' for available commands</div>
                <div class="terminal-line">System initialized... <span class="blink">‚ñà</span></div>
            </div>
            <div class="terminal-input">
                <span class="prompt">cyberspy@education:~$</span>
                <input type="text" class="input-field" id="commandInput" placeholder="Enter command..." autocomplete="off">
            </div>
        </div>
    </div>

    <div class="status-bar">
        <div class="status-item">
            <span>Status:</span>
            <span style="color: #00ff41;">ONLINE</span>
            <span class="blink">‚óè</span>
        </div>
        <div class="status-item">
            <span>Mode:</span>
            <span style="color: #00ccff;">EDUCATIONAL</span>
        </div>
        <div class="status-item">
            <span>Time:</span>
            <span id="currentTime"></span>
        </div>
    </div>

    <script>
        // Audio context for typing sounds
        let audioContext;
        let isTyping = false;

        function initAudio() {
            try {
                audioContext = new (window.AudioContext || window.webkitAudioContext)();
            } catch (e) {
                console.log('Audio not supported');
            }
        }

        function playTypingSound() {
            if (!audioContext) return;
            
            const oscillator = audioContext.createOscillator();
            const gainNode = audioContext.createGain();
            
            oscillator.connect(gainNode);
            gainNode.connect(audioContext.destination);
            
            // Create a subtle typing sound
            oscillator.frequency.setValueAtTime(800 + Math.random() * 400, audioContext.currentTime);
            oscillator.type = 'square';
            
            gainNode.gain.setValueAtTime(0.1, audioContext.currentTime);
            gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.1);
            
            oscillator.start(audioContext.currentTime);
            oscillator.stop(audioContext.currentTime + 0.1);
        }

        function typewriterEffect(element, text, callback = null) {
            if (!audioContext) initAudio();
            
            element.textContent = '';
            isTyping = true;
            let i = 0;
            
            function typeChar() {
                if (i < text.length) {
                    element.textContent += text.charAt(i);
                    playTypingSound();
                    i++;
                    setTimeout(typeChar, 20 + Math.random() * 30);
                } else {
                    isTyping = false;
                    if (callback) callback();
                }
            }
            
            typeChar();
        }

        function addToTerminalWithEffect(text, callback = null) {
            const line = document.createElement('div');
            line.className = 'terminal-line';
            terminalOutput.appendChild(line);
            terminalOutput.scrollTop = terminalOutput.scrollHeight;
            
            typewriterEffect(line, text, callback);
        }

        // Cryptography Functions
        function caesarShift(text, shift, decrypt = false) {
            if (decrypt) shift = -shift;
            return text.replace(/[A-Za-z]/g, function(char) {
                const start = char <= 'Z' ? 65 : 97;
                return String.fromCharCode((char.charCodeAt(0) - start + shift + 26) % 26 + start);
            });
        }

        function vigenereShift(text, key, decrypt = false) {
            key = key.toUpperCase().replace(/[^A-Z]/g, '');
            if (!key) return text;
            
            let result = '';
            let keyIndex = 0;
            
            for (let i = 0; i < text.length; i++) {
                const char = text[i];
                if (/[A-Za-z]/.test(char)) {
                    const start = char <= 'Z' ? 65 : 97;
                    const shift = key.charCodeAt(keyIndex % key.length) - 65;
                    const actualShift = decrypt ? -shift : shift;
                    result += String.fromCharCode((char.charCodeAt(0) - start + actualShift + 26) % 26 + start);
                    keyIndex++;
                } else {
                    result += char;
                }
            }
            return result;
        }

        function getFrequencyAnalysis(text) {
            const freq = {};
            const letters = text.replace(/[^A-Za-z]/g, '').toUpperCase();
            
            for (let char of letters) {
                freq[char] = (freq[char] || 0) + 1;
            }
            
            return freq;
        }

        function caesarEncrypt() {
            const input = document.getElementById('caesarInput').value;
            const shift = parseInt(document.getElementById('caesarShift').value) || 3;
            const result = caesarShift(input, shift);
            
            typewriterEffect(document.getElementById('caesarOutput'), 
                `Encrypted: ${result}\nShift: ${shift}`);
        }

        function caesarDecrypt() {
            const input = document.getElementById('caesarInput').value;
            const shift = parseInt(document.getElementById('caesarShift').value) || 3;
            const result = caesarShift(input, shift, true);
            
            typewriterEffect(document.getElementById('caesarOutput'), 
                `Decrypted: ${result}\nShift: ${shift}`);
        }

        function caesarBruteForce() {
            const input = document.getElementById('caesarInput').value;
            const output = document.getElementById('caesarOutput');
            
            let results = "BRUTE FORCE ATTACK - ALL POSSIBLE SHIFTS:\n";
            results += "=" .repeat(40) + "\n";
            
            for (let i = 1; i <= 25; i++) {
                const decrypted = caesarShift(input, i, true);
                results += `Shift ${i.toString().padStart(2)}: ${decrypted}\n`;
            }
            
            typewriterEffect(output, results);
        }

        function vigenereEncrypt() {
            const input = document.getElementById('vigenereInput').value;
            const key = document.getElementById('vigenereKey').value;
            if (!key) {
                typewriterEffect(document.getElementById('vigenereOutput'), 'Error: Please enter a key');
                return;
            }
            
            const result = vigenereShift(input, key);
            typewriterEffect(document.getElementById('vigenereOutput'), 
                `Encrypted: ${result}\nKey: ${key.toUpperCase()}`);
        }

        function vigenereDecrypt() {
            const input = document.getElementById('vigenereInput').value;
            const key = document.getElementById('vigenereKey').value;
            if (!key) {
                typewriterEffect(document.getElementById('vigenereOutput'), 'Error: Please enter a key');
                return;
            }
            
            const result = vigenereShift(input, key, true);
            typewriterEffect(document.getElementById('vigenereOutput'), 
                `Decrypted: ${result}\nKey: ${key.toUpperCase()}`);
        }

        function vigenereAnalyze() {
            const input = document.getElementById('vigenereInput').value;
            const output = document.getElementById('vigenereOutput');
            
            let analysis = "VIGEN√àRE CIPHER ANALYSIS\n";
            analysis += "=" .repeat(30) + "\n";
            analysis += "Attempting key length detection...\n\n";
            
            // Simple key length analysis using Index of Coincidence
            const cleanText = input.replace(/[^A-Za-z]/g, '').toUpperCase();
            
            for (let keyLen = 2; keyLen <= 10; keyLen++) {
                let ic = 0;
                for (let i = 0; i < keyLen; i++) {
                    let substring = '';
                    for (let j = i; j < cleanText.length; j += keyLen) {
                        substring += cleanText[j];
                    }
                    const freq = getFrequencyAnalysis(substring);
                    const n = substring.length;
                    if (n > 1) {
                        let sum = 0;
                        for (let char in freq) {
                            sum += freq[char] * (freq[char] - 1);
                        }
                        ic += sum / (n * (n - 1));
                    }
                }
                ic /= keyLen;
                analysis += `Key length ${keyLen}: IC = ${ic.toFixed(4)} ${ic > 0.06 ? '(Possible!)' : ''}\n`;
            }
            
            typewriterEffect(output, analysis);
        }

        function performFrequencyAnalysis() {
            const input = document.getElementById('frequencyInput').value;
            const freq = getFrequencyAnalysis(input);
            const chart = document.getElementById('frequencyChart');
            const output = document.getElementById('frequencyOutput');
            
            // Create frequency chart
            chart.innerHTML = '';
            const maxFreq = Math.max(...Object.values(freq));
            
            for (let i = 0; i < 26; i++) {
                const char = String.fromCharCode(65 + i);
                const count = freq[char] || 0;
                const percentage = maxFreq > 0 ? (count / maxFreq) * 100 : 0;
                
                const bar = document.createElement('div');
                bar.className = 'freq-bar';
                bar.innerHTML = `<div class="freq-letter">${char}</div><div class="freq-count" style="height: ${percentage}%"></div><div style="font-size: 8px;">${count}</div>`;
                chart.appendChild(bar);
            }
            
            // Analysis text
            const total = Object.values(freq).reduce((a, b) => a + b, 0);
            let analysis = "FREQUENCY ANALYSIS RESULTS\n";
            analysis += "=" .repeat(30) + "\n";
            analysis += `Total letters analyzed: ${total}\n\n`;
            analysis += "Most frequent letters:\n";
            
            const sorted = Object.entries(freq).sort((a, b) => b[1] - a[1]);
            sorted.slice(0, 5).forEach(([char, count]) => {
                const percent = ((count / total) * 100).toFixed(1);
                analysis += `${char}: ${count} (${percent}%)\n`;
            });
            
            analysis += "\nEnglish frequency: E(12.7%) T(9.1%) A(8.2%) O(7.5%) I(7.0%)";
            
            typewriterEffect(output, analysis);
        }

        function hybridCrack() {
            const input = document.getElementById('hybridInput').value;
            const output = document.getElementById('hybridOutput');
            
            if (!input.trim()) {
                typewriterEffect(output, 'Error: Please enter text to crack');
                return;
            }
            
            output.innerHTML = '';
            let resultCount = 0;
            
            function addResult(method, result, confidence) {
                resultCount++;
                const div = document.createElement('div');
                div.className = 'result-item';
                div.innerHTML = `<strong>${method}</strong> (${confidence}): ${result}`;
                div.onclick = () => {
                    navigator.clipboard.writeText(result);
                    addToTerminalWithEffect(`Copied to clipboard: ${result.substring(0, 50)}...`);
                };
                output.appendChild(div);
            }
            
            // Try Caesar cipher brute force
            for (let shift = 1; shift <= 25; shift++) {
                const result = caesarShift(input, shift, true);
                const englishness = calculateEnglishness(result);
                if (englishness > 0.3) {
                    addResult(`Caesar Shift ${shift}`, result, `${(englishness * 100).toFixed(0)}% match`);
                }
            }
            
            // Try common Vigen√®re keys
            const commonKeys = ['THE', 'AND', 'KEY', 'SECRET', 'CIPHER', 'CODE', 'WORD', 'PASS', 'LOCK'];
            commonKeys.forEach(key => {
                const result = vigenereShift(input, key, true);
                const englishness = calculateEnglishness(result);
                if (englishness > 0.2) {
                    addResult(`Vigen√®re Key: ${key}`, result, `${(englishness * 100).toFixed(0)}% match`);
                }
            });
            
            if (resultCount === 0) {
                addResult('No matches', 'Unable to crack with common methods. Try manual analysis.', 'Low');
            }
        }

        function calculateEnglishness(text) {
            const commonWords = ['THE', 'AND', 'FOR', 'ARE', 'BUT', 'NOT', 'YOU', 'ALL', 'CAN', 'HER', 'WAS', 'ONE', 'OUR', 'HAD', 'DAY', 'GET', 'USE', 'MAN', 'NEW', 'NOW', 'WAY', 'SAY', 'EACH', 'WHICH', 'THEIR'];
            const words = text.toUpperCase().replace(/[^A-Z\s]/g, '').split(/\s+/);
            const matches = words.filter(word => commonWords.includes(word)).length;
            return matches / Math.max(words.length, 1);
        }
        const canvas = document.getElementById('matrixCanvas');
        const ctx = canvas.getContext('2d');

        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;

        const matrix = "ABCDEFGHIJKLMNOPQRSTUVWXYZ123456789@#$%^&*()*&^%+-/~{[|`]}";
        const matrixArray = matrix.split("");

        const fontSize = 10;
        const columns = canvas.width / fontSize;

        const drops = [];
        for(let x = 0; x < columns; x++) {
            drops[x] = 1;
        }

        function drawMatrix() {
            ctx.fillStyle = 'rgba(0, 0, 0, 0.04)';
            ctx.fillRect(0, 0, canvas.width, canvas.height);

            ctx.fillStyle = '#00ff41';
            ctx.font = fontSize + 'px arial';

            for(let i = 0; i < drops.length; i++) {
                const text = matrixArray[Math.floor(Math.random() * matrixArray.length)];
                ctx.fillText(text, i * fontSize, drops[i] * fontSize);

                if(drops[i] * fontSize > canvas.height && Math.random() > 0.975) {
                    drops[i] = 0;
                }
                drops[i]++;
            }
        }

        setInterval(drawMatrix, 35);

        // Terminal functionality
        const terminalOutput = document.getElementById('terminalOutput');
        const commandInput = document.getElementById('commandInput');

        const commands = {
            help: {
                description: "Show available commands",
                execute: () => {
                    return [
                        "Available Commands:",
                        "==================",
                        "help         - Show this help menu",
                        "scan         - Perform network scan",
                        "status       - Show system status",
                        "nmap         - Simulate network mapping",
                        "whoami       - Display current user",
                        "ls           - List directory contents",
                        "pwd          - Show current directory",
                        "ping         - Ping a target (educational)",
                        "encrypt      - Encrypt a message",
                        "decrypt      - Decrypt a message",
                        "caesar       - Caesar cipher tools",
                        "vigenere     - Vigen√®re cipher tools", 
                        "frequency    - Frequency analysis",
                        "crack        - Auto-crack cipher",
                        "clear        - Clear terminal",
                        "matrix       - Toggle matrix effect",
                        "mission      - Show mission briefing"
                    ];
                }
            },
            scan: {
                description: "Perform network scan",
                execute: () => {
                    const results = [
                        "Initiating network scan...",
                        "Scanning ports 1-1000...",
                        "Port 22/tcp  open  ssh",
                        "Port 80/tcp  open  http",
                        "Port 443/tcp open  https",
                        "Port 3306/tcp closed mysql",
                        "Scan completed. 3 open ports found."
                    ];
                    return results;
                }
            },
            nmap: {
                description: "Simulate network mapping",
                execute: (args) => {
                    const target = args[0] || "127.0.0.1";
                    return [
                        `Starting Nmap scan on ${target}...`,
                        "Host is up (0.00050s latency).",
                        "PORT     STATE SERVICE",
                        "22/tcp   open  ssh",
                        "80/tcp   open  http",
                        "443/tcp  open  https",
                        "MAC Address: 00:14:22:01:23:45 (Dell Inc.)",
                        "Nmap scan completed."
                    ];
                }
            },
            whoami: {
                description: "Display current user",
                execute: () => ["cyberspy-agent"]
            },
            pwd: {
                description: "Show current directory",
                execute: () => ["/home/cyberspy/mission"]
            },
            ls: {
                description: "List directory contents",
                execute: () => [
                    "mission_briefing.txt",
                    "tools/",
                    "logs/",
                    "encrypted_files/",
                    "network_data.pcap"
                ]
            },
            ping: {
                description: "Ping a target",
                execute: (args) => {
                    const target = args[0] || "google.com";
                    return [
                        `PING ${target} (8.8.8.8): 56 data bytes`,
                        "64 bytes from 8.8.8.8: icmp_seq=0 ttl=117 time=12.1 ms",
                        "64 bytes from 8.8.8.8: icmp_seq=1 ttl=117 time=11.9 ms",
                        "64 bytes from 8.8.8.8: icmp_seq=2 ttl=117 time=12.3 ms",
                        "--- ping statistics ---",
                        "3 packets transmitted, 3 received, 0% packet loss"
                    ];
                }
            },
            status: {
                description: "Show system status",
                execute: () => [
                    "System Status Report:",
                    "=====================",
                    "Firewall: ACTIVE",
                    "Antivirus: UP TO DATE",
                    "Network: SECURE",
                    "Encryption: AES-256",
                    "Mission Status: 78% COMPLETE",
                    "Agent Level: INTERMEDIATE"
                ]
            },
            encrypt: {
                description: "Encrypt a message",
                execute: (args) => {
                    const message = args.join(' ') || "Hello World";
                    const encrypted = btoa(message);
                    return [
                        `Original: ${message}`,
                        `Encrypted (Base64): ${encrypted}`,
                        "Encryption complete."
                    ];
                }
            },
            decrypt: {
                description: "Decrypt a message",
                execute: (args) => {
                    const encrypted = args[0] || "SGVsbG8gV29ybGQ=";
                    try {
                        const decrypted = atob(encrypted);
                        return [
                            `Encrypted: ${encrypted}`,
                            `Decrypted: ${decrypted}`,
                            "Decryption complete."
                        ];
                    } catch (e) {
                        return ["Error: Invalid encrypted message"];
                    }
                }
            },
            clear: {
                description: "Clear terminal",
                execute: () => {
                    terminalOutput.innerHTML = '<div class="terminal-line">Terminal cleared.</div>';
                    return [];
                }
            },
            matrix: {
                description: "Toggle matrix effect",
                execute: () => {
                    const canvas = document.getElementById('matrixCanvas');
                    canvas.style.opacity = canvas.style.opacity === '0' ? '0.1' : '0';
                    return ["Matrix effect toggled."];
                }
            },
            mission: {
                description: "Show mission briefing",
                execute: () => [
                    "MISSION BRIEFING - CLASSIFICATION: EDUCATIONAL",
                    "==============================================",
                    "Objective: Learn cybersecurity fundamentals",
                    "Skills to master:",
                    "‚Ä¢ Network scanning and reconnaissance",
                    "‚Ä¢ Encryption and decryption techniques",
                    "‚Ä¢ System monitoring and analysis",
                    "‚Ä¢ Security best practices",
                    "‚Ä¢ Advanced cryptanalysis",
                    "‚Ä¢ Cipher breaking techniques",
                    "",
                    "New Skills Unlocked:",
                    "‚Ä¢ Caesar cipher cryptanalysis",
                    "‚Ä¢ Vigen√®re cipher breaking",
                    "‚Ä¢ Frequency analysis",
                    "‚Ä¢ Hybrid cipher cracking",
                    "",
                    "Remember: Always use these skills ethically!",
                    "Good luck, Agent!"
                ]
            },
            caesar: {
                description: "Caesar cipher educational tool",
                execute: (args) => {
                    if (args.length < 2) {
                        return ["Usage: caesar <encrypt/decrypt/crack> <text> [shift]"];
                    }
                    const action = args[0];
                    const text = args.slice(1, -1).join(' ') || args[1];
                    const shift = parseInt(args[args.length - 1]) || 3;
                    
                    if (action === 'encrypt') {
                        return [`Caesar Encrypted: ${caesarShift(text, shift)}`];
                    } else if (action === 'decrypt') {
                        return [`Caesar Decrypted: ${caesarShift(text, shift, true)}`];
                    } else if (action === 'crack') {
                        const results = [];
                        for (let i = 1; i <= 25; i++) {
                            results.push(`Shift ${i}: ${caesarShift(text, i, true)}`);
                        }
                        return results;
                    }
                    return ["Invalid action. Use: encrypt, decrypt, or crack"];
                }
            },
            vigenere: {
                description: "Vigen√®re cipher educational tool",
                execute: (args) => {
                    if (args.length < 3) {
                        return ["Usage: vigenere <encrypt/decrypt> <text> <key>"];
                    }
                    const action = args[0];
                    const key = args[args.length - 1];
                    const text = args.slice(1, -1).join(' ');
                    
                    if (action === 'encrypt') {
                        return [`Vigen√®re Encrypted: ${vigenereShift(text, key)}`];
                    } else if (action === 'decrypt') {
                        return [`Vigen√®re Decrypted: ${vigenereShift(text, key, true)}`];
                    }
                    return ["Invalid action. Use: encrypt or decrypt"];
                }
            },
            frequency: {
                description: "Perform frequency analysis",
                execute: (args) => {
                    const text = args.join(' ');
                    if (!text) return ["Usage: frequency <text to analyze>"];
                    
                    const freq = getFrequencyAnalysis(text);
                    const sorted = Object.entries(freq).sort((a, b) => b[1] - a[1]);
                    const results = ["Frequency Analysis:", "=================="];
                    sorted.slice(0, 10).forEach(([char, count]) => {
                        results.push(`${char}: ${count} occurrences`);
                    });
                    return results;
                }
            },
            crack: {
                description: "Auto-crack unknown cipher",
                execute: (args) => {
                    const text = args.join(' ');
                    if (!text) return ["Usage: crack <encrypted text>"];
                    
                    const results = ["Auto-cracking cipher...", "======================"];
                    
                    // Try Caesar
                    for (let i = 1; i <= 25; i++) {
                        const attempt = caesarShift(text, i, true);
                        if (calculateEnglishness(attempt) > 0.3) {
                            results.push(`Possible Caesar (shift ${i}): ${attempt}`);
                        }
                    }
                    
                    // Try common Vigen√®re keys
                    const keys = ['KEY', 'SECRET', 'CIPHER', 'CODE'];
                    keys.forEach(key => {
                        const attempt = vigenereShift(text, key, true);
                        if (calculateEnglishness(attempt) > 0.2) {
                            results.push(`Possible Vigen√®re (key ${key}): ${attempt}`);
                        }
                    });
                    
                    if (results.length === 2) {
                        results.push("No clear matches found. Manual analysis recommended.");
                    }
                    
                    return results;
                }
            }
        };

        function addToTerminal(text) {
            const line = document.createElement('div');
            line.className = 'terminal-line';
            line.textContent = text;
            terminalOutput.appendChild(line);
            terminalOutput.scrollTop = terminalOutput.scrollHeight;
        }

        commandInput.addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                const input = commandInput.value.trim();
                if (input) {
                    addToTerminal(`cyberspy@education:~$ ${input}`);
                    
                    const args = input.split(' ');
                    const command = args[0].toLowerCase();
                    const commandArgs = args.slice(1);

                    if (commands[command]) {
                        const output = commands[command].execute(commandArgs);
                        if (Array.isArray(output)) {
                            let i = 0;
                            function showNextLine() {
                                if (i < output.length) {
                                    addToTerminalWithEffect(output[i], () => {
                                        i++;
                                        setTimeout(showNextLine, 100);
                                    });
                                }
                            }
                            showNextLine();
                        }
                    } else {
                        addToTerminalWithEffect(`Command not found: ${command}. Type 'help' for available commands.`);
                    }
                }
                commandInput.value = '';
            }
        });

        // Update time
        function updateTime() {
            const now = new Date();
            document.getElementById('currentTime').textContent = 
                now.toLocaleTimeString('en-US', { hour12: false });
        }
        setInterval(updateTime, 1000);
        updateTime();

        // Simulate dynamic data updates
        function updateMetrics() {
            document.getElementById('connections').textContent = Math.floor(Math.random() * 100) + 20;
            document.getElementById('packets').textContent = (Math.floor(Math.random() * 2000) + 500).toLocaleString();
            document.getElementById('bandwidth').textContent = (Math.random() * 100).toFixed(1) + ' MB/s';
            document.getElementById('cpu').textContent = Math.floor(Math.random() * 60) + 20 + '%';
            document.getElementById('memory').textContent = Math.floor(Math.random() * 40) + 50 + '%';
            
            // Update progress bars
            document.getElementById('networkProgress').style.width = (Math.random() * 100) + '%';
            document.getElementById('securityProgress').style.width = '85%';
            document.getElementById('systemProgress').style.width = (Math.random() * 100) + '%';
            document.getElementById('missionProgressBar').style.width = '78%';
        }

        setInterval(updateMetrics, 3000);
        updateMetrics();

        // Resize canvas on window resize
        window.addEventListener('resize', function() {
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;
        });

        // Focus on terminal input
        commandInput.focus();
    </script>
</body>
</html>